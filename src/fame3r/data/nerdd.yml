module:
  rank: 3
  name: fame3r
  visible_name: FAME3R
  visible: False
  logo: !image logo.svg
  logo_title: Sites of Metabolism
  logo_caption: Regioselectivity prediction for phase 1 and phase 2 metabolism
  example_smiles: CN1CCN(Cc2ccc(cc2)C(=O)Nc3ccc(C)c(Nc4nccc(n4)c5cccnc5)c3)CC1 (imatinib)
  batch_size: 10

  title: Prediction of Phase 1 and Phase 2 Sites of Metabolism (SOMs)
  description: |
    FAME3R is a reimplementation of FAME3, a collection of machine learning models for prediction of both phase 1 and phase 2 sites of metabolism (SOMs).
    SOMs are atoms where a metabolic reaction gets initiated and, thus, are a good starting point for determining the metabolic fate of xenobiotic compounds.

  partners:
    - name: University of Vienna
      logo: !image logo_vienna.gif
      url: https://www.univie.ac.at/en

  publications:
    - title: "FAME 3R: A Fast, Compact, Flexible, and Practical Re-Design of the FAME 3 Model for Predicting Sites of Metabolism"
      authors:
        - first_name: Roxane Axel
          last_name: Jacob
        - first_name: Leo
          last_name: Gaskin
        - first_name: Thomas
          last_name: Seidel
        - first_name: Ya
          last_name: Chen
        - first_name: Angelica
          last_name: Mazzolari
        - first_name: Johannes
          last_name: Kirchmair
          email: johannes.kirchmair@univie.ac.at
      year: 2025
      journal: ChemRxiv (preprint)
      doi: 10.26434/chemrxiv-2025-1vnp0

  about: |
    FAME 3R is a suite of random forest models designed to predict both Phase 1 and Phase 2 sites of metabolism (SOMs). SOMs are the atoms where metabolic reactions are initiated, making them the starting points for understanding the metabolic fate of xenobiotic compounds. The source code for FAME 3R is publicly available on GitHub: [https://github.com/molinfo-vienna/FAME3R](https://github.com/molinfo-vienna/FAME3R).

    The FAME 3R models are trained on the MetaQSAR database and are available in four distinct versions, each tailored to specific subsets of metabolic reactions:

    - **Full Training Set**: Includes both Phase 1 and Phase 2 metabolism.
    - **CYP-Mediated Reactions:** Focuses on reactions mediated by cytochrome P450 enzymes.
    - **Phase 1-Associated Reactions:** Covers Phase 1 metabolism (mainly redox and hydrolysis reactions).
    - **Phase 2-Associated Reactions:** Covers Phase 2 metabolism (mainly conjugation reactions).

    These trained models are freely available for non-commercial research purposes via the NERDD platform and can also be downloaded from Zenodo: [https://doi.org/10.5281/zenodo.17223468](https://doi.org/10.5281/zenodo.17223468) for local execution. For-profit institutions require a commercial license from the Universit√† degli Studi di Milano to access the MetaQSAR-derived models.

    FAME 3R incorporates two key metrics for assessing prediction reliability and uncertainty:

    - **FAME Score:** A similarity-based applicability domain score ranging from 0 to 1, where 1 indicates the most reliable predictions.
    - **Shannon Entropy:** A measure of uncertainty ranging from 0 to 1, with 0 representing the most certain predictions.

    For legacy purposes, the earlier FAME 3 models remain accessible at [https://nerdd.univie.ac.at/fame3](https://nerdd.univie.ac.at/fame3).

  job_parameters:
    - name: metabolism_subset
      visible_name: Metabolism subset
      type: string
      choices:
        - value: all
          label: Phase 1 and 2 metabolism
        - value: phase1
          label: Phase 1 metabolism
        - value: phase2
          label: Phase 2 metabolism
        - value: cyp
          label: CYP-mediated metabolism
      default: all
    - name: fame_score
      visible_name: Compute FAME score for applicability domain
      type: bool
      default: False
    - name: shannon_entropy
      visible_name: Compute Shannon entropy for applicability domain
      type: bool
      default: False

  result_properties:
    - name: prediction
      visible_name: Probability
      type: float
      sortable: True
      level: atom
      format: .2f
      color_palette:
        type: sequential
        domain:
          - 0
          - 1
        range:
          - neutral
          - positive
    - name: prediction_binary
      visible_name: SOM
      type: bool
      sortable: True
      level: atom
      color_palette:
        range:
          - negative
          - positive
    - name: fame_score
      visible_name: Fame score
      type: float
      sortable: True
      level: atom
      format: .2f
      color_palette:
        type: sequential
        domain:
          - 0
          - 1
        range:
          - neutral
          - positive
    - name: shannon_entropy
      visible_name: Shannon entropy
      type: float
      sortable: True
      level: atom
      format: .2f
      color_palette:
        type: sequential
        domain:
          - 0
          - 1
        range:
          - positive
          - neutral
